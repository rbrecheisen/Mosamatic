{% extends "help/base.html" %}
{% load static %}
{% block help_content %}
<div>
    <a href="/back">Back</a><br>
    <br>
    <h2>User manual</h2>
    <br>
    <h4>1. Starting the application</h4>
    After you have installed Mosamatic™ with the MSI installer, you can find the application in your Windows or Mac OS
    applications list. Just double-click the Mosamatic™ application. This will pop up a terminal window as illustrated
    in Figure X.<br>
    <br>
    <!-- <img src="{% static 'help/images/mm_manual_terminal_window_startup.png' %}" width="600px;"> -->
    <br>
    The terminal window will show some output logging as Mosamatic™ is busy launching. The last logging you should see
    are the lines:<br>
    <br>
    <div style="background-color: lightgray;">
        <code>
            ...<br>
            Starting development server at http://0.0.0.0:8000/<br>
            Quit the server with CTRL-BREAK"<br>
        </code>    
    </div>
    <br>
    If you see these lines, you will know Mosamatic™ is ready for use. Open your webbrowser and navigate to the 
    address <b>http://0.0.0.0:8000</b>. You should now see the Mosamatic™ login page (see Figure X). Make sure to 
    create a bookmark for this address so you don't have to remember it.<br>
    <br>
    <img src="{% static 'help/images/mm_manual_login_page.png' %}" width="600px;">
    <br>
    The default login for Mosamatic™ is username admin and password admin. If you run the application locally on your PC
    or laptop this is fine. If you are hosting the application on a centralized server and want to allow multiple users
    to access it, you need to create additional accounts in the administrator pages.<br>
    <br>
    After you login, you will see the Filesets page, initially empty (Figure X). This is the starting page of Mosamatic™ 
    and allows you to upload and view all Filesets available in your user account. Whenever you upload a new Fileset, 
    it will be linked to your user account (in this case "admin"). If another user were to login, she would NOT see 
    your Filesets.<br>
    <br>
    <img src="{% static 'help/images/mm_manual_filesets_page.png' %}" width="400px;">
    <br>
    Click <b>Choose Files</b> and navivate to the directory where your DICOM images are stored. In this directory you need to
    select each DICOM image you want to upload. Multiple selection is allowed (see Figure X).<br>
    <br>
    <img src="{% static 'help/images/mm_manual_filesets_page_select_files.png' %}" width="600px;">
    <br>
    After selecting the DICOM images, click the <b>Open</b> button in the file dialog window. The <b>Select Files</b> widget will 
    show the number of DICOM images you have selected. Next, provide a name for the new Fileset. This is not mandatory
    but recommended to easily distinguish Filesets among each other. Figure X shows a Fileset name <b>input</b>.<br>
    <br>
    <img src="{% static 'help/images/mm_manual_filesets_page_upload.png' %}" width="400px;">
    <br>
    The Fileset list shows each Fileset available in Mosamatic™. It shows the Fileset name, owner, number of files in the Fileset,
    time when it was uploaded and one or more commands, e.g., <b>delete</b>. When you click <b>delete</b> the Fileset will be 
    deleted.<br>
    <br>
    When you click on the Fileset name (it is a hyperlink) you will see a page showing the individual files in this Fileset 
    (see Figure X). The files can be clicked as well if Mosamatic™ recognizes their type. For example, PNG images have the 
    extension .png and can be viewed directly in the browser. Text (.txt) and JSON (.json) files can be viewed as plain text 
    in the browser as well. CSV (.csv) files can also be viewed and will be automatically rendered as a table (see Figure X).<br>
    <br>
    <!-- <img src="{% static 'help/images/mm_manual_filesets_page_upload.png' %}" width="400px;"> -->
    <br>


    <h4>2. Tasks and filesets</h4>
    The design of Mosamatic™ is based on <b>Tasks</b> with <b>Parameters</b> that work on <b>Filesets</b>. A Task takes one or 
    more Filesets as input and produces one or more Filesets as output. The outputs from one Task can be used as input to 
    the next Task allowing you to run whole sequences of Tasks (pipelines) on your data. Each task can also be configured 
    with zero or more Parameters.<br>
    <br>
    You start by uploading DICOM images to Mosamatic™. This will result in a Fileset that you can see in the "Filesets" page. 
    Before you upload the images, you can optionally provide a name for the Fileset. If not, a random name will be generated.
    This is illustrated in Figure X.<br>
    <br>

    <br>
    Currently, Mosamatic™ supports the following tasks:<br>
    <br>
    <table style="width:1000px;">
        <tr>
            <th>Task name</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>DecompressDicomFilesTask</td>
            <td>Decompresses DICOM images that are JPEG2000 compressed</td>
        </tr>
        <tr>
            <td>RescaleDicomFilesTask</td>
            <td>Rescales DICOM images to a fixed square size (default: 512 pixels)</td>
        </tr>
        <tr>
            <td>MuscleFatSegmenationL3Task</td>
            <td>Automatically annotates muscle and fat in CT images at L3 level</td>
        </tr>
        <tr>
            <td>CalculateMetricsTask</td>
            <td>Calculates body composition metrics from muscle and fat annotations</td>
        </tr>
        <tr>
            <td>CreatePngsFromSegmentationsTask</td>
            <td>Creates PNG images from muscle and fat annotations for easy online and offline viewing</td>
        </tr>
    </table>
</div>
{% endblock %}